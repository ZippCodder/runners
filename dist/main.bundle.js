(()=>{"use strict";var t={28:(t,e,i)=>{i.d(e,{Z:()=>s});var h=i(645),n=i.n(h)()((function(t){return t[1]}));n.push([t.id,"html,\nbody {\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n  overscroll-behavior: contain;\n}\n\ncanvas {\nbackground: white;\n}\n\n",""]);const s=n},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,h){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(h)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(n[r]=!0)}for(var d=0;d<t.length;d++){var a=[].concat(t[d]);h&&n[a[0]]||(i&&(a[2]?a[2]="".concat(i," and ").concat(a[2]):a[2]=i),e.push(a))}},e}},379:(t,e,i)=>{var h,n=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),s=[];function r(t){for(var e=-1,i=0;i<s.length;i++)if(s[i].identifier===t){e=i;break}return e}function d(t,e){for(var i={},h=[],n=0;n<t.length;n++){var d=t[n],a=e.base?d[0]+e.base:d[0],o=i[a]||0,c="".concat(a," ").concat(o);i[a]=o+1;var l=r(c),u={css:d[1],media:d[2],sourceMap:d[3]};-1!==l?(s[l].references++,s[l].updater(u)):s.push({identifier:c,updater:p(u,e),references:1}),h.push(c)}return h}function a(t){var e=document.createElement("style"),h=t.attributes||{};if(void 0===h.nonce){var s=i.nc;s&&(h.nonce=s)}if(Object.keys(h).forEach((function(t){e.setAttribute(t,h[t])})),"function"==typeof t.insert)t.insert(e);else{var r=n(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var o,c=(o=[],function(t,e){return o[t]=e,o.filter(Boolean).join("\n")});function l(t,e,i,h){var n=i?"":h.media?"@media ".concat(h.media," {").concat(h.css,"}"):h.css;if(t.styleSheet)t.styleSheet.cssText=c(e,n);else{var s=document.createTextNode(n),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(s,r[e]):t.appendChild(s)}}function u(t,e,i){var h=i.css,n=i.media,s=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(h+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=h;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(h))}}var f=null,g=0;function p(t,e){var i,h,n;if(e.singleton){var s=g++;i=f||(f=a(e)),h=l.bind(null,i,s,!1),n=l.bind(null,i,s,!0)}else i=a(e),h=u.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return h(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;h(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===h&&(h=Boolean(window&&document&&document.all&&!window.atob)),h));var i=d(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var h=0;h<i.length;h++){var n=r(i[h]);s[n].references--}for(var a=d(t,e),o=0;o<i.length;o++){var c=r(i[o]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}i=a}}}}},e={};function i(h){if(e[h])return e[h].exports;var n=e[h]={id:h,exports:{}};return t[h](n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var h in e)i.o(e,h)&&!i.o(t,h)&&Object.defineProperty(t,h,{enumerable:!0,get:e[h]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var h={};(()=>{i.d(h,{kg:()=>f,J3:()=>l,w3:()=>v,vM:()=>y,Iq:()=>w,HU:()=>u});var t=i(379),e=i.n(t),n=i(28);e()(n.Z,{insert:"head",singleton:!1}),n.Z.locals;var s,r=io();r.on("prev_players",(function(t){var e=JSON.parse(t);for(var i in e){var h=e[i];if(h.username!==v.username){var n=new y(0,0,h.username,0);for(var s in h)s in n&&(n[s]=h[s]);n.width=f.percent(f.charWidth,!0),n.height=f.percent(f.charHeight,!0),n.x=f.percent(n.posX,!0)-n.width/2,n.y=f.percent(n.posY,!0)-n.height/2,w[h.username]=n}}})),r.on("new_player",(function(t){var e=JSON.parse(t),i=new y(0,0,e.username,0);for(var h in e)h in i&&(i[h]=e[h]);i.width=f.percent(f.charWidth,!0),i.height=f.percent(f.charHeight,!0),i.eyeDim=f.percent(3,!0),i.handWidth=f.percent(4,!0),i.handHeight=f.percent(4,!0),i.x=f.percent(i.posX,!0)-i.width/2,i.y=f.percent(i.posY,!0)-i.height/2,w[e.username]=i})),r.on("new_player_update",(function(t){var e=JSON.parse(t);if(e.username in w){var i=w[e.username],h=e.rotation,n=e.running,s=e.speed,r=(e.x,e.y,e.posX),d=e.posY,a=(e.fixedCenter,e.username);"boolean"==typeof n?i.run(!1):i.run(!0),i.rotation=h,i.speed=s,i.username=a,i.x=f.percent(r-1,!0)-f.charWidth/2-i.handWidth,i.y=f.percent(d-1,!0)-f.charHeight/2-i.handHeight}}));var d=prompt("What is your username?"),a=document.querySelector("canvas");a.onclick=function(){document.body.requestFullscreen()};var o=a.getContext("2d");function c(t,e,i,h,n){t||(o.lineWidth=2),e||(o.strokeStyle="black"),i||(o.fillStyle="white"),h||(o.globalAlpha=1)}c(),o.save();var l,u,f={charWidth:15,charHeight:15,controlSize:20,joystickSize:void 0,scale:3,maxWidth:1e4,maxHeight:1e4,speedFactor:.1,speed:void 0,width:window.innerWidth,height:window.innerHeight,prevDim:void 0,globalCenter:{x:window.innerWidth/2,y:window.innerHeight/2},mapAnchor:{x:window.innerWidth/2,y:window.innerHeight/2},percent:function(t,e,i){return e?t/100*f.height/f.scale+t/100*f.width/f.scale:i?t/100*i:t/100*f.width}},g=new function(t,e,i){this.width=5e3,this.height=5e3,this.render=function(){var t=f.mapAnchor,e=t.x,i=t.y,h=f.percent;c(),o.beginPath(),o.rect(e-h(60.5,!0),i-h(50,!0),h(125,!0),h(100,!0)),o.rect(e-h(25,!0),i-h(25,!0),h(50,!0),h(50,!0)),o.stroke()}}(5e3,5e3,(function(){var t=f.mapAnchor,e=t.x,i=t.y,h=f.percent;c(),o.beginPath(),o.rect(e-h(60.5,!0),i-h(50,!0),h(125,!0),h(100,!0)),o.rect(e-h(25,!0),i-h(25,!0),h(50,!0),h(50,!0)),o.stroke()})),p=function(){function t(){this.active=!1,this.mouseX=0,this.mouseY=0,this.angle=0,this.quad=0,this.distance=0,this.touch=void 0,this.mouseCenter={x:0,y:0}}return t.prototype.render=function(){c(),o.moveTo(this.mouseCenter.x,this.mouseCenter.y),o.beginPath(),f.joystickSize&&o.arc(this.mouseCenter.x,this.mouseCenter.y,f.joystickSize,0,2*Math.PI),o.globalAlpha=.5,o.fill(),o.stroke(),this.mouseX&&this.mouseY&&f.joystickSize&&(o.beginPath(),f.joystickSize&&o.arc(this.mouseX,this.mouseY,f.joystickSize/2||10,0,2*Math.PI),o.fillStyle="gray",o.globalAlpha=.5,o.fill()),o.stroke()},t}();window.addEventListener("touchstart",(function(t){var e=t.touches[t.touches.length-1],i=e.pageX,h=e.pageY,n=new p;n.touch=t.touches.length-1,n.mouseCenter.x=i,n.mouseCenter.y=h,n.mouseX=i,n.mouseY=h,n.active=!0,i>window.innerWidth/2&&3!==t.touches.length&&h>window.innerHeight/2?null==(null==u?void 0:u.touch)&&(u=n):i<window.innerWidth/2&&3!==t.touches.length&&h>window.innerHeight/2&&null==(null==l?void 0:l.touch)&&(l=n)})),window.addEventListener("touchend",(function(t){l&&u&&t.touches&&1==t.touches.length?t.touches[0].pageX>window.innerWidth/2?(l.distance=0,v.rotation=-(null==l?void 0:l.angle),l=void 0):(v.rotation=-(null==u?void 0:u.angle),u=void 0):(l&&(l.distance=0,v.rotation=-(null==l?void 0:l.angle),l=void 0),u&&(v.rotation=-(null==u?void 0:u.angle),u=void 0))})),window.addEventListener("touchmove",(function(t){function e(e){if(t.touches[e.touch]){var i,h=t.touches[e.touch],n=h.pageX,s=h.pageY,r=Math.round(Math.sqrt(Math.pow(n-e.mouseCenter.x,2)+Math.pow(s-e.mouseCenter.y,2))),d=Math.round(180*Math.atan((e.mouseCenter.x-n)/(e.mouseCenter.y-s))/Math.PI);(i=n<e.mouseCenter.x&&s>e.mouseCenter.y?1:n>e.mouseCenter.x&&s>e.mouseCenter.y?2:n>e.mouseCenter.x&&s<e.mouseCenter.y?3:0)>0&&(d=3==i?90*i+180-(90*i-d)+180:90*i+180-(90*i-d)),e.quad=i,r<f.joystickSize&&(e.mouseX=n,e.mouseY=s,e.angle=d*Math.PI/180,e.distance=r)}}u&&e(u),l&&e(l)}));var m=[],w={},y=function(){function t(t,e,i,h){var n=this;this.width=f.percent(f.charWidth,!0),this.height=f.percent(f.charHeight,!0),this.eyePos="open",this.running=!1,this.speed=.1,this.eyeDim=f.percent(3,!0),this.handWidth=f.percent(4,!0),this.handHeight=f.percent(4,!0),this.handPos="middle",this.blink=setInterval((function(){n.eyePos="closed",setTimeout((function(){n.eyePos="open"}),1e3)}),6e3),this.posX=t,this.posY=e,this.x=f.percent(t,!0)-this.width,this.y=f.percent(e,!0)-this.height,this.fixedCenter={x:this.x+this.width/2,y:this.y+this.height/2},this.rotation=h||0,this.username=i}return t.prototype.run=function(t){var e=this;if(t&&0==this.running){var i=200-100*this.speed+100;this.running=setInterval((function(){e.handPos="middle",setTimeout((function(){e.handPos="top",setTimeout((function(){e.handPos="bottom",setTimeout((function(){e.handPos="middle"}),i/3)}),i/3)}),i/3)}),i)}else t||!1===this.running||(clearInterval(this.running),this.running=!1)},t.prototype.recalculate=function(t,e){this.width=f.percent(f.charWidth,!0),this.height=f.percent(f.charHeight,!0),this.x=f.percent(this.posX,!0)-this.width/2,this.y=f.percent(this.posY,!0)-this.height/2,this.handWidth=f.percent(4,!0),this.handHeight=f.percent(4,!0),this.eyeDim=f.percent(3,!0)},t.prototype.drawHands=function(){var t=f.mapAnchor.x+this.x,e=f.mapAnchor.y+this.y;o.lineWidth=4,"middle"==this.handPos?(o.strokeRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.strokeRect(t+this.width+1,e+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.fillRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.fillRect(t+this.width+1,e+this.height/2-this.handHeight/2,this.handWidth,this.handHeight)):"top"==this.handPos?(o.strokeRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.strokeRect(t+this.width+1,e+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(t+this.width+1,e+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight)):(o.strokeRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.strokeRect(t+this.width+1,e+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(t-this.handWidth-1,e+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(t+this.width+1,e+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight))},t.prototype.drawEyes=function(){var t=f.mapAnchor.x+this.x,e=f.mapAnchor.y+this.y;o.fillStyle="black","open"==this.eyePos?(o.fillRect(t+this.width/5,e,this.eyeDim,this.eyeDim),o.fillRect(t+this.width/5*3,e,this.eyeDim,this.eyeDim)):(o.fillRect(t+this.width/5,e+this.eyeDim/2,this.eyeDim,this.eyeDim/4),o.fillRect(t+this.width/5*3,e+this.eyeDim/2,this.eyeDim,this.eyeDim/4))},t.prototype.render=function(){var t=f.mapAnchor.x+this.x,e=f.mapAnchor.y+this.y;o.beginPath(),c(),o.restore(),o.save(),o.translate(t+this.width/2,e+this.height/2),o.rotate(this.rotation),o.translate(-t+-this.width/2,-e+-this.height/2),o.fillStyle="white",o.fillRect(t,e,this.width,this.height),o.strokeRect(t,e,this.width,this.height),c(),this.drawEyes(),c(),this.drawHands(),o.restore(),o.save(),o.textAlign="center",o.font=f.percent(5,!0)+"px Arial",o.fillStyle="black",o.fillText(this.username,t+this.width/2,e-f.percent(8,!0)),c(),o.restore(),o.save(),o.beginPath()},t}(),v=new(function(){function t(t,e,i){var h=this;this.width=f.percent(f.charWidth,!0),this.height=f.percent(f.charHeight,!0),this.eyePos="open",this.rotation=0,this.running=!1,this.eyeDim=f.percent(3,!0),this.handWidth=f.percent(4,!0),this.handHeight=f.percent(4,!0),this.handPos="middle",this.blink=setInterval((function(){h.eyePos="closed",setTimeout((function(){h.eyePos="open"}),1e3)}),6e3),this.x=e||f.maxWidth-this.width/2,this.y=i||f.maxHeight-this.height/2,this.fixedX=f.width/2-this.width/2,this.fixedY=f.height/2-this.height/2,this.username=t,this.fixedCenter={x:this.fixedX+this.width/2,y:this.fixedY+this.height/2}}return t.prototype.recalculate=function(t,e){this.x=t||f.maxWidth-this.width/2,this.y=e||f.maxHeight-this.height/2,this.fixedX=f.width/2-this.width/2,this.fixedY=f.height/2-this.height/2,this.fixedCenter={x:this.fixedX+this.width/2,y:this.fixedY+this.height/2},this.width=f.percent(f.charWidth,!0),this.height=f.percent(f.charHeight,!0),this.handWidth=f.percent(4,!0),this.handHeight=f.percent(4,!0),this.eyeDim=f.percent(3,!0)},t.prototype.drawHands=function(){o.lineWidth=4,"middle"==this.handPos?(o.strokeRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.strokeRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.fillRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),o.fillRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight)):"top"==this.handPos?(o.strokeRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.strokeRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight)):(o.strokeRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.strokeRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(this.fixedX-this.handWidth-1,this.fixedY+this.height/2-this.handHeight/2+f.percent(2,!0),this.handWidth,this.handHeight),o.fillRect(this.fixedX+this.width+1,this.fixedY+this.height/2-this.handHeight/2-f.percent(2,!0),this.handWidth,this.handHeight))},t.prototype.drawEyes=function(){o.fillStyle="black","open"==this.eyePos?(o.fillRect(this.fixedX+this.width/5,this.fixedY,this.eyeDim,this.eyeDim),o.fillRect(this.fixedX+this.width/5*3,this.fixedY,this.eyeDim,this.eyeDim)):(o.fillRect(this.fixedX+this.width/5,this.fixedY+this.eyeDim/2,this.eyeDim,this.eyeDim/4),o.fillRect(this.fixedX+this.width/5*3,this.fixedY+this.eyeDim/2,this.eyeDim,this.eyeDim/4))},t.prototype.render=function(){var t=this;if(c(),o.restore(),o.save(),this.fixedX=f.width/2-this.width/2,this.fixedY=f.height/2-this.height/2,c(),o.restore(),o.save(),o.translate(this.fixedCenter.x,this.fixedCenter.y),o.rotate(-(null==u?void 0:u.angle)||-(null==l?void 0:l.angle)||this.rotation||0),o.translate(-this.fixedCenter.x,-this.fixedCenter.y),o.fillStyle="white",o.fillRect(this.fixedX,this.fixedY,this.width,this.height),o.strokeRect(this.fixedX,this.fixedY,this.width,this.height),c(),this.drawEyes(),c(),(null==f?void 0:f.speed)&&l&&!this.running&&(null==l?void 0:l.distance)>0){var e=200-100*f.speed+100;this.running=setInterval((function(){t.handPos="middle",setTimeout((function(){t.handPos="top",setTimeout((function(){t.handPos="bottom",setTimeout((function(){t.handPos="middle"}),e/3)}),e/3)}),e/3)}),e)}else this.running&&!(null==l?void 0:l.distance)&&(clearInterval(this.running),this.running=!1);this.drawHands(),o.restore(),o.save(),o.textAlign="center",o.font=f.percent(5,!0)+"px Arial",o.fillStyle="black",o.fillText(this.username,this.fixedCenter.x,this.fixedCenter.y-f.percent(8,!0)-this.height/2),c(),o.restore(),o.save()},t}())(d);function x(t){if(a.style.width=window.innerWidth+"px",a.style.height=window.innerHeight+"px",a.width=window.innerWidth,a.height=window.innerHeight,f.prevDim={width:f.width,height:f.height},t||(f.mapAnchor.x=window.innerWidth/2+f.percent((f.mapAnchor.x-f.globalCenter.x)/f.width*100,!1,window.innerWidth),f.mapAnchor.y=window.innerHeight/2+f.percent((f.mapAnchor.y-f.globalCenter.y)/f.height*100,!1,window.innerHeight)),f.width=window.innerWidth,f.height=window.innerHeight,f.joystickSize=f.percent(f.controlSize,!0),f.globalCenter={x:window.innerWidth/2,y:window.innerHeight/2},f.speed=f.percent(f.speedFactor,!0),m.length)for(var e=0,i=m;e<i.length;e++){var h=i[e];null==h||h.recalculate()}if(Object.keys(w).length)for(var n in w)w[n].recalculate();v.recalculate()}window.addEventListener("resize",(function(){x()})),function(){var t,e,i=/<\d\.?\d?>/.exec(v.username);for(var h in i&&(e=null===(t=i[0])||void 0===t?void 0:t.replace(/<|>/g,""),v.username=v.username.replace(i[0],"")),e&&(f.speedFactor=parseFloat(e)),s=new y(0,0,v.username))h in v&&(s[h]=v[h]);s.x=0,s.y=0,r.emit("new_user",JSON.stringify(s))}(),x(!0),requestAnimationFrame((function t(){if(o.clearRect(0,0,f.width,f.height),g&&g.render(),Object.keys(w).length)for(var e in w)w[e].render();if(m.length)for(var i=0,h=m;i<h.length;i++)h[i].render();if(v.render(),null==l?void 0:l.active){l.render();var n=f,d=n.mapAnchor,a=n.speed;if(n.percent,a)switch(a*=5,l.quad){case 0:d.x+=a,d.y+=a;break;case 1:d.x+=a,d.y-=a;break;case 2:d.x-=a,d.y-=a;break;case 3:d.x-=a,d.y+=a}}(null==u?void 0:u.active)&&u.render(),function(){var t=v.rotation,e=v.running,i=v.speed,h=(v.x,v.y,v.posX,v.posY,v.fixedCenter,v.username);s.rotation=-(null==u?void 0:u.angle)||-(null==l?void 0:l.angle)||t||0,s.running=e,s.speed=i,s.posX=-Math.round((f.mapAnchor.x-f.globalCenter.x)/f.percent(1,!0)),s.posY=-Math.round((f.mapAnchor.y-f.globalCenter.y)/f.percent(1,!0)),s.username=h,r.emit("new_update",JSON.stringify(s))}(),requestAnimationFrame(t)}))})()})();