(()=>{"use strict";var e={28:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(645),h=i.n(n)()((function(e){return e[1]}));h.push([e.id,"html,\nbody {\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n  overscroll-behavior: contain;\n}\n\ncanvas {\nbackground: white;\n}\n\n",""]);const r=h},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var h={};if(n)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(h[s]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);n&&h[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),t.push(c))}},t}},379:(e,t,i)=>{var n,h=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),r=[];function s(e){for(var t=-1,i=0;i<r.length;i++)if(r[i].identifier===e){t=i;break}return t}function o(e,t){for(var i={},n=[],h=0;h<e.length;h++){var o=e[h],c=t.base?o[0]+t.base:o[0],a=i[c]||0,d="".concat(c," ").concat(a);i[c]=a+1;var l=s(d),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==l?(r[l].references++,r[l].updater(f)):r.push({identifier:d,updater:g(f,t),references:1}),n.push(d)}return n}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var s=h(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var a,d=(a=[],function(e,t){return a[e]=t,a.filter(Boolean).join("\n")});function l(e,t,i,n){var h=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=d(t,h);else{var r=document.createTextNode(h),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function f(e,t,i){var n=i.css,h=i.media,r=i.sourceMap;if(h?e.setAttribute("media",h):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var u=null,p=0;function g(e,t){var i,n,h;if(t.singleton){var r=p++;i=u||(u=c(t)),n=l.bind(null,i,r,!1),h=l.bind(null,i,r,!0)}else i=c(t),n=f.bind(null,i,t),h=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else h()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var h=s(i[n]);r[h].references--}for(var c=o(e,t),a=0;a<i.length;a++){var d=s(i[a]);0===r[d].references&&(r[d].updater(),r.splice(d,1))}i=c}}}}},t={};function i(n){if(t[n])return t[n].exports;var h=t[n]={id:n,exports:{}};return e[n](h,h.exports,i),h.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{i.d(n,{kg:()=>p,J3:()=>v,w3:()=>T,vM:()=>b,Iq:()=>W,HU:()=>y,Xl:()=>u,j_:()=>m});var e=i(379),t=i.n(e),h=i(28);function r(e,t,i){var n=p.percent,h=p.mapAnchor,r=h.x,s=h.y;u.beginPath(),"left"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(20,!0),n(50,!0)),u.rect(r+n(e+8,!0),s+n(t,!0),n(6,!0),n(50,!0)),u.rect(r+n(e-5,!0),s+n(t+2,!0),n(5,!0),n(3,!0)),u.rect(r+n(e-5,!0),s+n(t+45,!0),n(5,!0),n(3,!0)),u.moveTo(r+n(e+2,!0),s+n(t,!0)),u.lineTo(r+n(e+2,!0),s+n(t+50,!0))):"right"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(20,!0),n(50,!0)),u.rect(r+n(e+6,!0),s+n(t,!0),n(6,!0),n(50,!0)),u.rect(r+n(e+20,!0),s+n(t+2,!0),n(5,!0),n(3,!0)),u.rect(r+n(e+20,!0),s+n(t+45,!0),n(5,!0),n(3,!0)),u.moveTo(r+n(e+18,!0),s+n(t,!0)),u.lineTo(r+n(e+18,!0),s+n(t+50,!0))):"up"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(50,!0),n(20,!0)),u.rect(r+n(e,!0),s+n(t+8,!0),n(50,!0),n(6,!0)),u.rect(r+n(e+45,!0),s+n(t-5,!0),n(3,!0),n(5,!0)),u.rect(r+n(e+2,!0),s+n(t-5,!0),n(3,!0),n(5,!0)),u.moveTo(r+n(e,!0),s+n(t+2,!0)),u.lineTo(r+n(e+50,!0),s+n(t+2,!0))):"down"==i&&(u.rect(r+n(e,!0),s+n(t,!0),n(50,!0),n(20,!0)),u.rect(r+n(e,!0),s+n(t+6,!0),n(50,!0),n(6,!0)),u.rect(r+n(e+45,!0),s+n(t+20,!0),n(3,!0),n(5,!0)),u.rect(r+n(e+2,!0),s+n(t+20,!0),n(3,!0),n(5,!0)),u.moveTo(r+n(e,!0),s+n(t+18,!0)),u.lineTo(r+n(e+50,!0),s+n(t+18,!0))),u.stroke()}function s(e,t,i){var n=p.percent,h=p.mapAnchor,r=h.x,s=h.y;u.beginPath(),"horizontal"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(130,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t+60,!0),n(130,!0),n(10,!0)),u.rect(r+n(e+26,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0)),u.rect(r+n(e+78,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"vertical"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(130,!0)),u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(130,!0)),u.rect(r+n(e+33.5,!0),s+n(t+26,!0),n(3,!0),n(26,!0)),u.rect(r+n(e+33.5,!0),s+n(t+78,!0),n(3,!0),n(26,!0))):"L_corner"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(60,!0),n(10,!0)),u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(70,!0)),u.rect(r+n(e,!0),s+n(t+60,!0),n(10,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"R_corner"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(70,!0)),u.rect(r+n(e+10,!0),s+n(t,!0),n(60,!0),n(10,!0)),u.rect(r+n(e+60,!0),s+n(t+60,!0),n(10,!0),n(10,!0)),u.rect(r+n(e+44,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"U_corner"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(70,!0)),u.rect(r+n(e+10,!0),s+n(t+60,!0),n(60,!0),n(10,!0)),u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(10,!0)),u.rect(r+n(e+44,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"D_corner"==i?(u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(70,!0)),u.rect(r+n(e,!0),s+n(t+60,!0),n(60,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"L_conn"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(40,!0)),u.rect(r+n(e,!0),s+n(t+90,!0),n(10,!0),n(40,!0)),u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(130,!0)),u.rect(r+n(e+33.5,!0),s+n(t+26,!0),n(3,!0),n(26,!0)),u.rect(r+n(e+33.5,!0),s+n(t+78,!0),n(3,!0),n(26,!0))):"R_conn"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(10,!0),n(130,!0)),u.rect(r+n(e+60,!0),s+n(t,!0),n(10,!0),n(40,!0)),u.rect(r+n(e+60,!0),s+n(t+90,!0),n(10,!0),n(40,!0)),u.rect(r+n(e+33.5,!0),s+n(t+26,!0),n(3,!0),n(26,!0)),u.rect(r+n(e+33.5,!0),s+n(t+78,!0),n(3,!0),n(26,!0))):"U_conn"==i?(u.rect(r+n(e,!0),s+n(t,!0),n(40,!0),n(10,!0)),u.rect(r+n(e+90,!0),s+n(t,!0),n(40,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t+60,!0),n(130,!0),n(10,!0)),u.rect(r+n(e+26,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0)),u.rect(r+n(e+78,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))):"D_conn"==i&&(u.rect(r+n(e,!0),s+n(t,!0),n(130,!0),n(10,!0)),u.rect(r+n(e,!0),s+n(t+60,!0),n(40,!0),n(10,!0)),u.rect(r+n(e+90,!0),s+n(t+60,!0),n(40,!0),n(10,!0)),u.rect(r+n(e+26,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0)),u.rect(r+n(e+78,!0),s+n(t+33.5,!0),n(26,!0),n(3,!0))),u.stroke()}function o(e,t,i){var n=p.percent,h=p.mapAnchor,r=h.x,s=h.y;u.beginPath(),u.rect(r+n(e,!0),s+n(t,!0),n(35,!0),n(40,!0)),u.rect(r+n(e,!0),s+n(t-15,!0),n(35,!0),n(15,!0)),u.rect(r+n(e+5,!0),s+n(t+10,!0),n(25,!0),n(20,!0)),u.rect(r+n(e+2,!0),s+n(t+30,!0),n(31,!0),n(3,!0)),u.fillStyle="black",u.font=n(5,!0)+"px Arial",u.fillText(i,r+n(e+17.5,!0),s+n(t+7,!0)),"LOTTERY"==i?(u.rect(r+n(e+9.5,!0),s+n(t+22,!0),n(4,!0),n(8,!0)),u.rect(r+n(e+9.5,!0),s+n(t+26,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+9.5,!0),s+n(t+28,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+15.5,!0),s+n(t+18,!0),n(4,!0),n(12,!0)),u.rect(r+n(e+15.5,!0),s+n(t+22,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+15.5,!0),s+n(t+26,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+21.5,!0),s+n(t+20,!0),n(4,!0),n(8,!0)),u.rect(r+n(e+21.5,!0),s+n(t+24,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+21.5,!0),s+n(t+26,!0),n(4,!0),n(2,!0)),u.rect(r+n(e+21.5,!0),s+n(t+28,!0),n(4,!0),n(2,!0))):"RANKINGS"==i?(u.rect(r+n(e+7,!0),s+n(t+13,!0),n(21,!0),n(3,!0)),u.rect(r+n(e+7,!0),s+n(t+18,!0),n(21,!0),n(3,!0)),u.rect(r+n(e+7,!0),s+n(t+23,!0),n(21,!0),n(3,!0))):"PVP"==i&&(u.rect(r+n(e+16.5,!0),s+n(t+24,!0),n(2,!0),n(4,!0)),u.rect(r+n(e+14.5,!0),s+n(t+23,!0),n(6,!0),n(1,!0)),u.moveTo(r+n(e+16,!0),s+n(t+23,!0)),u.lineTo(r+n(e+16,!0),s+n(t+15,!0)),u.lineTo(r+n(e+17.5,!0),s+n(t+12,!0)),u.moveTo(r+n(e+19,!0),s+n(t+23,!0)),u.lineTo(r+n(e+19,!0),s+n(t+15,!0)),u.lineTo(r+n(e+17.5,!0),s+n(t+12,!0)),u.moveTo(r+n(e+17.5,!0),s+n(t+23,!0)),u.lineTo(r+n(e+17.5,!0),s+n(t+12,!0))),u.stroke()}function c(e,t){var i=p.percent,n=p.mapAnchor,h=n.x,r=n.y;u.beginPath(),u.rect(h+i(e-2,!0),r+i(t-2,!0),i(4,!0),i(4,!0)),u.rect(h+i(e+3,!0),r+i(t-2,!0),i(4,!0),i(4,!0)),u.rect(h+i(e-2,!0),r+i(t+3,!0),i(4,!0),i(4,!0)),u.rect(h+i(e+3,!0),r+i(t+3,!0),i(4,!0),i(4,!0)),u.stroke(),u.beginPath(),u.fillStyle="white",u.fillRect(h+i(e,!0),r+i(t,!0),i(5,!0),i(5,!0)),u.rect(h+i(e,!0),r+i(t,!0),i(5,!0),i(5,!0)),u.stroke(),m()}function a(e,t,i){var n=p.percent,h=p.mapAnchor,r=h.x,s=h.y,o=i.split(" "),c=o[0],a=o[1];u.beginPath(),u.fillRect(r+n(e,!0),s+n(t,!0),n(40,!0),n(20,!0)),u.fillRect(r+n(e+17.5,!0),s+n(t+20,!0),n(5,!0),n(25,!0)),u.rect(r+n(e,!0),s+n(t,!0),n(40,!0),n(20,!0)),u.rect(r+n(e+17.5,!0),s+n(t+20,!0),n(5,!0),n(25,!0)),u.fillStyle="black",u.font=n(7,!0)+"px Arial",c&&a?(u.fillText(c,r+n(e+20,!0),s+n(t+8,!0)),u.fillText(a,r+n(e+20,!0),s+n(t+17,!0))):u.fillText(c,r+n(e+20,!0),s+n(t+13,!0)),u.stroke(),m()}t()(h.Z,{insert:"head",singleton:!1}),h.Z.locals;var d,l=io({autoConnect:!1});l.on("players",(function(e){for(var t in e){var i=e[t];if(i.username!=T.username){var n=new b(0,0,i.username,0);for(var h in i)h in n&&(n[h]=i[h]);n.width=p.percent(p.charWidth,!0),n.height=p.percent(p.charHeight,!0),n.eyeDim=p.percent(3,!0),n.handWidth=p.percent(4,!0),n.handHeight=p.percent(4,!0),n.x=p.percent(i.posX,!0)-n.width/2,n.y=p.percent(i.posY,!0)-n.height/2,W[i.username]=n}}})),l.on("new_player_update",(function(e){if(!(e.username in W)){var t=new b(0,0,e.username,0);for(var i in e)i in t&&(t[i]=e[i]);t.width=p.percent(p.charWidth,!0),t.height=p.percent(p.charHeight,!0),t.eyeDim=p.percent(3,!0),t.handWidth=p.percent(4,!0),t.handHeight=p.percent(4,!0),t.x=p.percent(t.posX,!0)-t.width/2,t.y=p.percent(t.posY,!0)-t.height/2,W[e.username]=t}var n=W[e.username],h=e.rotation,r=e.running,s=e.speed,o=(e.x,e.y,e.posX),c=e.posY,a=(e.fixedCenter,e.username);"boolean"==typeof r?n.run(!1):n.run(!0),n.rotation=h,n.speed=s,n.username=a,n.x=p.percent(o-1,!0)-p.charWidth/2-n.handWidth,n.y=p.percent(c-1,!0)-p.charHeight/2-n.handHeight,n.posX=o,n.posY=c})),l.on("remove_player",(function(e){W[e]&&delete W[e]})),self.addEventListener("beforeunload",(function(){l.disconnect()}));var f=document.querySelector("canvas");f.onclick=function(){document.body.requestFullscreen()};var u=f.getContext("2d"),p={charWidth:15,charHeight:15,controlSize:20,joystickSize:void 0,scale:3,maxWidth:1e4,maxHeight:1e4,speedFactor:.1,speed:void 0,width:self.innerWidth,height:self.innerHeight,prevDim:void 0,globalCenter:{x:self.innerWidth/2,y:window.innerHeight/2},mapAnchor:{x:self.innerWidth/2,y:window.innerHeight/2},percent:function(e,t,i){return t?e/100*p.height/p.scale+e/100*p.width/p.scale:i?e/100*i:e/100*p.width}},g={lineWidth:self.innerWidth<=800?self.innerWidth<=400?2:3:4,strokeStyle:"black",fillStyle:"white",globalAlpha:1,textAlign:"center",font:p.percent(5,!0)+" Arial"};function m(e,t,i,n,h,r){e||(u.lineWidth=g.lineWidth),t||(u.strokeStyle=g.strokeStyle),i||(u.fillStyle=g.fillStyle),n||(u.globalAlpha=g.globalAlpha),h||(u.textAlign=g.textAlign),r||(u.font=g.font)}m(),u.save();var v,y,x=new function(e,t,i){this.width=5e3,this.height=5e3,this.render=function(){var e=p.mapAnchor,t=e.x,i=e.y,n=p.percent;m(),u.beginPath(),function(e,t){var i=p.percent,n=p.mapAnchor,h=n.x,r=n.y;u.beginPath(),u.rect(h+i(e,!0),r+i(t,!0),i(121,!0),i(100,!0)),u.rect(h+i(e+5,!0),r+i(t+5,!0),i(111,!0),i(90,!0)),u.rect(h+i(e+35.5,!0),r+i(t+25,!0),i(50,!0),i(50,!0)),u.stroke()}(-60.5,-50),r(85.5,-25,"left"),r(-105.5,-25,"right"),r(-25,-95,"down"),r(-25,75,"up"),s(-65,-264.5,"U_conn"),s(-195,-264.5,"horizontal"),s(65,-264.5,"horizontal"),s(195,-264.5,"L_corner"),s(195,-194.5,"vertical"),s(195,-64.5,"R_conn"),s(195,65.5,"vertical"),s(195,195.5,"D_corner"),s(65,195.5,"horizontal"),s(-65,195.5,"D_conn"),s(-195,195.5,"horizontal"),s(-265,195.5,"U_corner"),s(-265,65.5,"vertical"),s(-265,-64.5,"L_conn"),s(-265,-194.5,"vertical"),s(-265,-264.5,"R_corner"),s(-35,-394.5,"vertical"),o(70.5,-170,"LOTTERY"),o(-105.5,-170,"RANKINGS"),o(-17.5,-170,"PVP"),u.rect(t+n(-125.5,!0),i+n(-115,!0),n(251,!0),n(230,!0)),u.stroke(),c(52.5,-153),c(-32,-125),c(-128.5,-170),c(-158.5,-84),c(-138.5,2),c(-115.5,132),c(56,150),c(146,132),c(154,90),c(173,82),c(156,-7),c(166,-28),c(133,-89),c(127,-145),c(156,-167),c(0,161),c(-134.5,162),c(-146,23),a(100,100,"TOWN SQUARE"),a(65,-324.5,"HOSPITAL"),function(e,t){var i=p.percent,n=p.mapAnchor,h=n.x,r=n.y;u.beginPath(),u.rect(h+i(e,!0),r+i(t,!0),i(200,!0),i(150,!0)),u.rect(h+i(e+55,!0),r+i(t+150,!0),i(90,!0),i(40,!0)),u.rect(h+i(e+65,!0),r+i(t+110,!0),i(70,!0),i(40,!0)),u.rect(h+i(e+70,!0),r+i(t+135,!0),i(25,!0),i(3,!0)),u.moveTo(h+i(e+72,!0),r+i(t+135,!0)),u.lineTo(h+i(e+72,!0),r+i(t+133,!0)),u.moveTo(h+i(e+93,!0),r+i(t+135,!0)),u.lineTo(h+i(e+93,!0),r+i(t+133,!0)),u.rect(h+i(e+105,!0),r+i(t+135,!0),i(25,!0),i(3,!0)),u.moveTo(h+i(e+107,!0),r+i(t+135,!0)),u.lineTo(h+i(e+107,!0),r+i(t+133,!0)),u.moveTo(h+i(e+128,!0),r+i(t+135,!0)),u.lineTo(h+i(e+128,!0),r+i(t+133,!0)),u.rect(h+i(e+15,!0),r+i(t+100,!0),i(35,!0),i(20,!0)),u.rect(h+i(e+13,!0),r+i(t+120,!0),i(39,!0),i(3,!0)),u.rect(h+i(e+150,!0),r+i(t+100,!0),i(35,!0),i(20,!0)),u.rect(h+i(e+148,!0),r+i(t+120,!0),i(39,!0),i(3,!0)),u.rect(h+i(e+77.5,!0),r+i(t+115,!0),i(10,!0),i(15,!0)),u.rect(h+i(e+112.5,!0),r+i(t+115,!0),i(10,!0),i(15,!0)),u.font=i(35,!0)+"px Arial",u.textAlign="center",u.strokeText("+",h+i(e+100,!0),r+i(t+105,!0)),u.moveTo(h+i(e+100,!0),r+i(t+110,!0)),u.lineTo(h+i(e+100,!0),r+i(t+150,!0)),u.moveTo(h+i(e,!0),r+i(t+80,!0)),u.lineTo(h+i(e+200,!0),r+i(t+80,!0)),u.stroke(),m()}(-100,-584.5)}}(5e3,5e3,(function(){var e=p.mapAnchor,t=e.x,i=e.y,n=p.percent;m(),u.beginPath(),function(e,t){var i=p.percent,n=p.mapAnchor,h=n.x,r=n.y;u.beginPath(),u.rect(h+i(e,!0),r+i(-50,!0),i(121,!0),i(100,!0)),u.rect(h+i(e+5,!0),r+i(-45,!0),i(111,!0),i(90,!0)),u.rect(h+i(-25,!0),r+i(-25,!0),i(50,!0),i(50,!0)),u.stroke()}(-60.5),r(85.5,-25,"left"),r(-105.5,-25,"right"),r(-25,-95,"down"),r(-25,75,"up"),s(-65,-264.5,"U_conn"),s(-195,-264.5,"horizontal"),s(65,-264.5,"horizontal"),s(195,-264.5,"L_corner"),s(195,-194.5,"vertical"),s(195,-64.5,"R_conn"),s(195,65.5,"vertical"),s(195,195.5,"D_corner"),s(65,195.5,"horizontal"),s(-65,195.5,"D_conn"),s(-195,195.5,"horizontal"),s(-265,195.5,"U_corner"),s(-265,65.5,"vertical"),s(-265,-64.5,"L_conn"),s(-265,-194.5,"vertical"),s(-265,-264.5,"R_corner"),s(-35,-394.5,"vertical"),o(70.5,-170,"LOTTERY"),o(-105.5,-170,"RANKINGS"),o(-17.5,-170,"PVP"),u.rect(t+n(-125.5,!0),i+n(-115,!0),n(251,!0),n(230,!0)),u.stroke(),c(52.5,-153),c(-32,-125),c(-128.5,-170),c(-158.5,-84),c(-138.5,2),c(-115.5,132),c(56,150),c(146,132),c(154,90),c(173,82),c(156,-7),c(166,-28),c(133,-89),c(127,-145),c(156,-167),c(0,161),c(-134.5,162),c(-146,23),a(100,100,"TOWN SQUARE"),a(65,-324.5,"HOSPITAL"),function(e,t){var i=p.percent,n=p.mapAnchor,h=n.x,r=n.y;u.beginPath(),u.rect(h+i(e,!0),r+i(t,!0),i(200,!0),i(150,!0)),u.rect(h+i(-45,!0),r+i(-434.5,!0),i(90,!0),i(40,!0)),u.rect(h+i(-35,!0),r+i(-474.5,!0),i(70,!0),i(40,!0)),u.rect(h+i(-30,!0),r+i(-449.5,!0),i(25,!0),i(3,!0)),u.moveTo(h+i(-28,!0),r+i(-449.5,!0)),u.lineTo(h+i(-28,!0),r+i(-451.5,!0)),u.moveTo(h+i(-7,!0),r+i(-449.5,!0)),u.lineTo(h+i(-7,!0),r+i(-451.5,!0)),u.rect(h+i(5,!0),r+i(-449.5,!0),i(25,!0),i(3,!0)),u.moveTo(h+i(7,!0),r+i(-449.5,!0)),u.lineTo(h+i(7,!0),r+i(-451.5,!0)),u.moveTo(h+i(28,!0),r+i(-449.5,!0)),u.lineTo(h+i(28,!0),r+i(-451.5,!0)),u.rect(h+i(-85,!0),r+i(-484.5,!0),i(35,!0),i(20,!0)),u.rect(h+i(-87,!0),r+i(-464.5,!0),i(39,!0),i(3,!0)),u.rect(h+i(50,!0),r+i(-484.5,!0),i(35,!0),i(20,!0)),u.rect(h+i(48,!0),r+i(-464.5,!0),i(39,!0),i(3,!0)),u.rect(h+i(-22.5,!0),r+i(-469.5,!0),i(10,!0),i(15,!0)),u.rect(h+i(12.5,!0),r+i(-469.5,!0),i(10,!0),i(15,!0)),u.font=i(35,!0)+"px Arial",u.textAlign="center",u.strokeText("+",h+i(0,!0),r+i(-479.5,!0)),u.moveTo(h+i(0,!0),r+i(-474.5,!0)),u.lineTo(h+i(0,!0),r+i(-434.5,!0)),u.moveTo(h+i(e,!0),r+i(t+80,!0)),u.lineTo(h+i(100,!0),r+i(t+80,!0)),u.stroke(),m()}(-100,-584.5)})),w=function(){function e(){this.active=!1,this.mouseX=0,this.mouseY=0,this.angle=0,this.quad=0,this.distance=0,this.touch=void 0,this.mouseCenter={x:0,y:0}}return e.prototype.render=function(){m(),u.moveTo(this.mouseCenter.x,this.mouseCenter.y),u.beginPath(),p.joystickSize&&u.arc(this.mouseCenter.x,this.mouseCenter.y,p.joystickSize,0,2*Math.PI),u.globalAlpha=.5,u.fill(),u.stroke(),this.mouseX&&this.mouseY&&p.joystickSize&&(u.beginPath(),p.joystickSize&&u.arc(this.mouseX,this.mouseY,p.joystickSize/2||10,0,2*Math.PI),u.fillStyle="gray",u.globalAlpha=.5,u.fill()),u.stroke()},e}();self.addEventListener("touchstart",(function(e){var t=e.touches[e.touches.length-1],i=t.pageX,n=t.pageY,h=new w;h.touch=e.touches.length-1,h.mouseCenter.x=i,h.mouseCenter.y=n,h.mouseX=i,h.mouseY=n,h.active=!0,i>self.innerWidth/2&&3!==e.touches.length&&n>window.innerHeight/2?null==(null==y?void 0:y.touch)&&(y=h):i<self.innerWidth/2&&3!==e.touches.length&&n>self.innerHeight/2&&null==(null==v?void 0:v.touch)&&(v=h)})),self.addEventListener("touchend",(function(e){v&&y&&e.touches&&1==e.touches.length?e.touches[0].pageX>self.innerWidth/2?(v.distance=0,T.rotation=-(null==v?void 0:v.angle),v=void 0):(T.rotation=-(null==y?void 0:y.angle),y=void 0):(v&&(v.distance=0,T.rotation=-(null==v?void 0:v.angle),v=void 0),y&&(T.rotation=-(null==y?void 0:y.angle),y=void 0))})),self.addEventListener("touchmove",(function(e){function t(t){if(e.touches[t.touch]){var i,n=e.touches[t.touch],h=n.pageX,r=n.pageY,s=Math.round(Math.sqrt(Math.pow(h-t.mouseCenter.x,2)+Math.pow(r-t.mouseCenter.y,2))),o=Math.round(180*Math.atan((t.mouseCenter.x-h)/(t.mouseCenter.y-r))/Math.PI);(i=h<t.mouseCenter.x&&r>t.mouseCenter.y?1:h>t.mouseCenter.x&&r>t.mouseCenter.y?2:h>t.mouseCenter.x&&r<t.mouseCenter.y?3:0)>0&&(o=3==i?90*i+180-(90*i-o)+180:90*i+180-(90*i-o)),t.quad=i,s<p.joystickSize&&(t.mouseX=h,t.mouseY=r,t.angle=o*Math.PI/180,t.distance=s)}}y&&t(y),v&&t(v)}));var H=[],W={},b=function(){function e(e,t,i,n){var h=this;this.width=p.percent(p.charWidth,!0),this.height=p.percent(p.charHeight,!0),this.eyePos="open",this.running=!1,this.speed=.1,this.eyeDim=p.percent(3,!0),this.handWidth=p.percent(4,!0),this.handHeight=p.percent(4,!0),this.handPos="middle",this.blink=setInterval((function(){h.eyePos="closed",setTimeout((function(){h.eyePos="open"}),1e3)}),6e3),this.posX=e,this.posY=t,this.x=p.percent(e,!0)-this.width,this.y=p.percent(t,!0)-this.height,this.fixedCenter={x:this.x+this.width/2,y:this.y+this.height/2},this.rotation=n||0,this.username=i}return e.prototype.run=function(e){var t=this;if(e&&0==this.running){var i=200-100*this.speed+100;this.running=setInterval((function(){t.handPos="middle",setTimeout((function(){t.handPos="top",setTimeout((function(){t.handPos="bottom",setTimeout((function(){t.handPos="middle"}),i/3)}),i/3)}),i/3)}),i)}else e||!1===this.running||(clearInterval(this.running),this.running=!1)},e.prototype.recalculate=function(e,t){this.width=p.percent(p.charWidth,!0),this.height=p.percent(p.charHeight,!0),this.x=p.percent(this.posX,!0)-this.width/2,this.y=p.percent(this.posY,!0)-this.height/2,this.handWidth=p.percent(4,!0),this.handHeight=p.percent(4,!0),this.eyeDim=p.percent(3,!0)},e.prototype.drawHands=function(){var e=p.mapAnchor.x+this.x,t=p.mapAnchor.y+this.y;u.lineWidth=2*g.lineWidth,"middle"==this.handPos?(u.strokeRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.strokeRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.fillRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.fillRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2,this.handWidth,this.handHeight)):"top"==this.handPos?(u.strokeRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.strokeRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight)):(u.strokeRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.strokeRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(e-this.handWidth-p.percent(.5,!0),t+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(e+this.width+p.percent(.5,!0),t+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight))},e.prototype.drawEyes=function(){var e=p.mapAnchor.x+this.x,t=p.mapAnchor.y+this.y;u.fillStyle="black","open"==this.eyePos?(u.fillRect(e+this.width/5,t,this.eyeDim,this.eyeDim),u.fillRect(e+this.width/5*3,t,this.eyeDim,this.eyeDim)):(u.fillRect(e+this.width/5,t+this.eyeDim/2,this.eyeDim,this.eyeDim/4),u.fillRect(e+this.width/5*3,t+this.eyeDim/2,this.eyeDim,this.eyeDim/4))},e.prototype.render=function(){var e=p.mapAnchor.x+this.x,t=p.mapAnchor.y+this.y;u.beginPath(),m(),u.restore(),u.save(),u.translate(e+this.width/2,t+this.height/2),u.rotate(this.rotation),u.translate(-e+-this.width/2,-t+-this.height/2),u.fillStyle="white",u.fillRect(e,t,this.width,this.height),u.strokeRect(e,t,this.width,this.height),m(),this.drawEyes(),m(),this.drawHands(),u.restore(),u.save(),u.textAlign="center",u.font=p.percent(5,!0)+"px Arial",u.fillStyle="black",u.fillText(this.username,e+this.width/2,t-p.percent(8,!0)),m(),u.restore(),u.save(),u.beginPath()},e}(),T=new(function(){function e(e,t,i){var n=this;this.width=p.percent(p.charWidth,!0),this.height=p.percent(p.charHeight,!0),this.eyePos="open",this.rotation=0,this.running=!1,this.eyeDim=p.percent(3,!0),this.handWidth=p.percent(4,!0),this.handHeight=p.percent(4,!0),this.handPos="middle",this.blink=setInterval((function(){n.eyePos="closed",setTimeout((function(){n.eyePos="open"}),1e3)}),6e3),this.username=e,this.x=t||p.maxWidth-this.width/2,this.y=i||p.maxHeight-this.height/2,this.fixedX=p.width/2-this.width/2,this.fixedY=p.height/2-this.height/2,this.fixedCenter={x:this.fixedX+this.width/2,y:this.fixedY+this.height/2}}return e.prototype.recalculate=function(e,t){this.x=e||p.maxWidth-this.width/2,this.y=t||p.maxHeight-this.height/2,this.fixedX=p.width/2-this.width/2,this.fixedY=p.height/2-this.height/2,this.fixedCenter={x:this.fixedX+this.width/2,y:this.fixedY+this.height/2},this.width=p.percent(p.charWidth,!0),this.height=p.percent(p.charHeight,!0),this.handWidth=p.percent(4,!0),this.handHeight=p.percent(4,!0),this.eyeDim=p.percent(3,!0)},e.prototype.drawHands=function(){u.lineWidth=2*g.lineWidth,"middle"==this.handPos?(u.strokeRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.strokeRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.fillRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight),u.fillRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2,this.handWidth,this.handHeight)):"top"==this.handPos?(u.strokeRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.strokeRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight)):(u.strokeRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.strokeRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(this.fixedX-this.handWidth-p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2+p.percent(2,!0),this.handWidth,this.handHeight),u.fillRect(this.fixedX+this.width+p.percent(.5,!0),this.fixedY+this.height/2-this.handHeight/2-p.percent(2,!0),this.handWidth,this.handHeight))},e.prototype.drawEyes=function(){u.fillStyle="black","open"==this.eyePos?(u.fillRect(this.fixedX+this.width/5,this.fixedY,this.eyeDim,this.eyeDim),u.fillRect(this.fixedX+this.width/5*3,this.fixedY,this.eyeDim,this.eyeDim)):(u.fillRect(this.fixedX+this.width/5,this.fixedY+this.eyeDim/2,this.eyeDim,this.eyeDim/4),u.fillRect(this.fixedX+this.width/5*3,this.fixedY+this.eyeDim/2,this.eyeDim,this.eyeDim/4))},e.prototype.render=function(){var e=this;if(this.fixedX=p.width/2-this.width/2,this.fixedY=p.height/2-this.height/2,m(),u.restore(),u.save(),u.translate(this.fixedCenter.x,this.fixedCenter.y),u.rotate(-(null==y?void 0:y.angle)||-(null==v?void 0:v.angle)||this.rotation||0),u.translate(-this.fixedCenter.x,-this.fixedCenter.y),u.fillStyle="white",u.fillRect(this.fixedX,this.fixedY,this.width,this.height),u.strokeRect(this.fixedX,this.fixedY,this.width,this.height),m(),this.drawEyes(),m(),(null==p?void 0:p.speed)&&v&&!this.running&&(null==v?void 0:v.distance)>0){var t=200-100*p.speed+100;this.running=setInterval((function(){e.handPos="middle",setTimeout((function(){e.handPos="top",setTimeout((function(){e.handPos="bottom",setTimeout((function(){e.handPos="middle"}),t/3)}),t/3)}),t/3)}),t)}else this.running&&!(null==v?void 0:v.distance)&&(clearInterval(this.running),this.running=!1);this.drawHands(),u.restore(),u.save(),u.textAlign="center",u.font=p.percent(5,!0)+"px Arial",u.fillStyle="black",u.fillText(this.username,this.fixedCenter.x,this.fixedCenter.y-p.percent(8,!0)-this.height/2),m(),u.restore(),u.save()},e}())("Laya<1>");function k(e){if(f.style.width=self.innerWidth+"px",f.style.height=self.innerHeight+"px",f.width=self.innerWidth,f.height=self.innerHeight,p.prevDim={width:p.width,height:p.height},e||(p.mapAnchor.x=self.innerWidth/2+p.percent((p.mapAnchor.x-p.globalCenter.x)/p.width*100,!1,self.innerWidth),p.mapAnchor.y=self.innerHeight/2+p.percent((p.mapAnchor.y-p.globalCenter.y)/p.height*100,!1,self.innerHeight)),p.width=self.innerWidth,p.height=self.innerHeight,p.joystickSize=p.percent(p.controlSize,!0),p.globalCenter={x:self.innerWidth/2,y:self.innerHeight/2},p.speed=p.percent(p.speedFactor,!0),H.length)for(var t=0,i=H;t<i.length;t++){var n=i[t];null==n||n.recalculate()}if(Object.keys(W).length)for(var h in W)W[h].recalculate();T.recalculate()}self.addEventListener("resize",(function(){k(),g.lineWidth=self.innerWidth<=800?self.innerWidth<=400?2:3:4,g.font=p.percent(5,!0)+" Arial"})),function(){var e;if(T.username){l.connect();var t=/<\d\.?\d?>/.exec(T.username),i=void 0;for(var n in t?(i=null===(e=t[0])||void 0===e?void 0:e.replace(/<|>/g,""),T.username=T.username.replace(t[0],"")+" Lv."+10*Number(i)):T.username=T.username+" Lv."+10*p.speedFactor,i&&(p.speedFactor=Number(i)),d=new b(0,0,T.username))n in T&&(d[n]=T[n]);d.speed=p.speedFactor,d.x=0,d.y=0,l.emit("new_user",d)}}(),k(!0),requestAnimationFrame((function e(){if(u.clearRect(0,0,p.width,p.height),x&&x.render(),Object.keys(W).length)for(var t in W)W[t].render();if(H.length)for(var i=0,n=H;i<n.length;i++)n[i].render();if(T.render(),null==v?void 0:v.active){v.render();var h=p,r=h.mapAnchor,s=h.speed;if(h.percent,s)switch(s*=5,v.quad){case 0:r.x+=s,r.y+=s;break;case 1:r.x+=s,r.y-=s;break;case 2:r.x-=s,r.y-=s;break;case 3:r.x-=s,r.y+=s}}(null==y?void 0:y.active)&&y.render(),function(){if(l.connected){var e=T.rotation,t=T.running,i=(T.speed,T.x,T.y,T.posX,T.posY,T.fixedCenter,T.username);d.rotation=-(null==y?void 0:y.angle)||-(null==v?void 0:v.angle)||e||0,d.running=t,d.speed=p.speedFactor,d.posX=-Math.round((p.mapAnchor.x-p.globalCenter.x)/p.percent(1,!0)),d.posY=-Math.round((p.mapAnchor.y-p.globalCenter.y)/p.percent(1,!0)),d.username=i,l.emit("new_update",d)}}(),requestAnimationFrame(e)}))})()})();